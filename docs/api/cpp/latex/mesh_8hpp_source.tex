\doxysection{mesh.\+hpp}
\hypertarget{mesh_8hpp_source}{}\label{mesh_8hpp_source}\index{mesh.hpp@{mesh.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ SPECSWD\_MESH\_H\_}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ SPECSWD\_MESH\_H\_}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <complex>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <array>}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{keyword}{namespace\ }specswd}
\DoxyCodeLine{00009\ \{}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structspecswd_1_1_mesh}{Mesh}}\ \{}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{comment}{//\ SEM\ Mesh}}
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{keywordtype}{int}\ nspec,nspec\_grl;\ \textcolor{comment}{//\ no.\ of\ elements\ for\ gll/grl\ layer}}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordtype}{int}\ nglob;\ \textcolor{comment}{//\ no.\ of\ unique\ points}}
\DoxyCodeLine{00020\ \ \ \ \ std::vector<int>\ ibool;\ \textcolor{comment}{//\ connectivity\ matrix,\ shape(nspec\ *\ NGLL\ +\ NGRL)}}
\DoxyCodeLine{00021\ \ \ \ \ std::vector<float>\ skel;\ \ \textcolor{comment}{//\ skeleton,\ shape(nspec\ *\ 2\ +\ 2)}}
\DoxyCodeLine{00022\ \ \ \ \ std::vector<float>\ znodes;\ \textcolor{comment}{//\ shape(nspec\ *\ NGLL\ +\ NGRL)}}
\DoxyCodeLine{00023\ \ \ \ \ std::vector<float>\ jaco;\ \textcolor{comment}{//\ jacobian\ for\ GLL,\ shape(nspec\ +\ 1)\ dz\ /\ dxi}}
\DoxyCodeLine{00024\ \ \ \ \ std::vector<float>\ zstore;\ \textcolor{comment}{//\ shape(nglob)\ \ }}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{comment}{//\ element\ type\ for\ each\ medium}}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{int}\ nspec\_ac,nspec\_el;}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{int}\ nspec\_ac\_grl,nspec\_el\_grl;}
\DoxyCodeLine{00029\ \ \ \ \ std::vector<char>\ is\_elastic,\ is\_acoustic;}
\DoxyCodeLine{00030\ \ \ \ \ std::vector<int>\ el\_elmnts,ac\_elmnts;\ \textcolor{comment}{//\ elements\ for\ each\ media,\ shape(nspec\_?\ +\ nspec\_?\_grl)}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{comment}{//\ unique\ array\ for\ acoustic/elastic}}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{int}\ nglob\_ac,\ nglob\_el;}
\DoxyCodeLine{00034\ \ \ \ \ std::vector<int>\ ibool\_el,\ ibool\_ac;\ \textcolor{comment}{//\ connectivity\ matrix,\ shape\ shape(nspec\_?\ +\ nspec\_?\_grl)}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{comment}{//\ density\ and\ elastic\ parameters}}
\DoxyCodeLine{00037\ \ \ \ \ std::vector<float>\ xrho\_ac;\ \textcolor{comment}{//\ shape(nspec\_ac\ *\ NGLL\ +\ nspec\_ac\_grl\ *\ NGRL)}}
\DoxyCodeLine{00038\ \ \ \ \ std::vector<float>\ xrho\_el;\ \textcolor{comment}{//\ shape\ (nsepc\_el\ *\ NGLL\ +\ nspec\_el\_grl\ *\ NGRL)}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{comment}{//\ attenuation/type\ flag}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{bool}\ HAS\_ATT;}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{int}\ SWD\_TYPE;\ \textcolor{comment}{//\ =0\ Love\ wave,\ =\ 1\ for\ Rayleigh\ =\ 2\ full\ aniso}}
\DoxyCodeLine{00043\ \ \ \ \ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{comment}{//\ vti\ media}}
\DoxyCodeLine{00045\ \ \ \ \ std::vector<float>\ xA,xC,xL,xeta,xN;\ \textcolor{comment}{//\ shape(nspec\_el\ *\ NGLL+\ nspec\_el\_grl\ *\ NGRL)}}
\DoxyCodeLine{00046\ \ \ \ \ std::vector<float>\ xQA,xQC,xQL,xQN;\ \textcolor{comment}{//\ shape(nspec\_el\ *\ NGLL+\ nspec\_el\_grl\ *\ NGRL),\ Q\ model}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ full\ anisotropy}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{int}\ nQmodel\_ani;\ \textcolor{comment}{//\ no.\ of\ Q\ used\ for\ anisotropy}}
\DoxyCodeLine{00050\ \ \ \ \ std::vector<float>\ xC21;\ \textcolor{comment}{//\ shape(21,nspec\_el\ *\ NGLL+\ nspec\_el\_grl\ *\ NGRL)}}
\DoxyCodeLine{00051\ \ \ \ \ std::vector<float>\ xQani;\ \textcolor{comment}{//\ shape(nQmodel\_ani,nspec\_el\ *\ NGLL+\ nspec\_el\_grl\ *\ NGRL)}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ fluid\ vti}}
\DoxyCodeLine{00054\ \ \ \ \ std::vector<float>\ xkappa\_ac,xQk\_ac;}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ fluid-\/elastic\ boundary}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{int}\ nfaces\_bdry;}
\DoxyCodeLine{00058\ \ \ \ \ std::vector<int>\ ispec\_bdry;\ \textcolor{comment}{//\ shape(nfaces\_bdry,2)\ (i,:)\ =\ [ispec\_ac,ispec\_el]}}
\DoxyCodeLine{00059\ \ \ \ \ std::vector<char>\ bdry\_norm\_direc;\ \textcolor{comment}{//\ \ shape(nfaces\_bdry),\ =\ 1\ point\ from\ acoustic\ -\/>\ z\ direc\ elastic}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{int}\ nz\_tomo,\ nregions;}
\DoxyCodeLine{00062\ \ \ \ \ std::vector<float>\ rho\_tomo;}
\DoxyCodeLine{00063\ \ \ \ \ std::vector<float>\ vpv\_tomo,vph\_tomo,vsv\_tomo,vsh\_tomo,eta\_tomo;}
\DoxyCodeLine{00064\ \ \ \ \ std::vector<float>\ QC\_tomo,QA\_tomo,QL\_tomo,QN\_tomo;}
\DoxyCodeLine{00065\ \ \ \ \ std::vector<float>\ c21\_tomo,Qani\_tomo;}
\DoxyCodeLine{00066\ \ \ \ \ std::vector<float>\ depth\_tomo;}
\DoxyCodeLine{00067\ \ \ \ \ std::vector<int>\ region\_bdry;\ \textcolor{comment}{//\ shape(nregions,2)}}
\DoxyCodeLine{00068\ \ \ \ \ std::vector<int>\ iregion\_flag;\ \textcolor{comment}{//\ shape(nspec\ +\ 1),\ return\ region\ flag}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{comment}{//\ interface\ with\ layered\ model}}
\DoxyCodeLine{00071\ \ \ \ \ std::vector<char>\ is\_el\_reg,\ is\_ac\_reg;\ \textcolor{comment}{//\ shape(nregions)}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordtype}{float}\ PHASE\_VELOC\_MIN,PHASE\_VELOC\_MAX;}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{comment}{//\ current\ frequency}}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordtype}{float}\ freq;}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{comment}{//\ public\ functions}}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_a6f7a9659aa684ed3deec61a052d99210}{read\_model}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *filename);}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_aab9af1030741cbde219c597a01f0d928}{create\_database}}(\textcolor{keywordtype}{float}\ freq,\textcolor{keywordtype}{float}\ phi);}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_a54b590b49e2487da305fa14afec5d509}{print\_model}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordtype}{void}\ print\_database()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{void}\ allocate\_1D\_model(\textcolor{keywordtype}{int}\ nz0,\textcolor{keywordtype}{int}\ swd\_type,\textcolor{keywordtype}{int}\ has\_att);}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_a92b766cce9236fbffb8be0fe08db961f}{create\_model\_attributes}}();}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{comment}{//\ interpolate\ model}}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_aa76f6c4eae327a427804cc0dbaee65a6}{interp\_model}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ *param,\textcolor{keyword}{const}\ std::vector<int>\ \&elmnts,std::vector<float>\ \&md)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_a6b644e2e2b248f8fb96d16cf50fb9199}{project\_kl}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ *frekl,\ \textcolor{keywordtype}{float}\ *kl\_out)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{comment}{//\ private\ functions\ below}}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{comment}{//\ ==============================}}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordtype}{void}\ create\_material\_info\_();}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{//\ 1-\/D\ model}}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_aa98f47ba93310099040171d8ae5ada75}{read\_model\_header\_}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *filename);}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_ad1f5ab06320e557580ee584cb7cdf096}{read\_model\_love\_}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *filename);}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_a63cd34c44c032adf74f9070db2fb65dc}{read\_model\_rayl\_}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *filename);}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_af0e109cbef2e0c7621081ff42f2b77bd}{read\_model\_full\_aniso\_}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *filename);}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{comment}{//\ create\ SEM\ database}}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{void}\ compute\_minmax\_veloc\_(\textcolor{keywordtype}{float}\ phi,std::vector<float>\ \&vmin,std::vector<float>\ \&vmax);}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_a4f9fec4bff8d0b96c8a61b24621d1ccf}{create\_db\_love\_}}();}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_adb07ca1f9594c4760df7de82c688100e}{create\_db\_rayl\_}}();}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structspecswd_1_1_mesh_ab7fa937fd34b2199c77777234007c408}{create\_db\_aniso\_}}();}
\DoxyCodeLine{00106\ \};}
\DoxyCodeLine{00107\ \ \ \ \ }
\DoxyCodeLine{00108\ \}\ \textcolor{comment}{//\ namespace\ specswd}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
